import csv
import time
from ares import CVESearch
csvContent = []

# Removes duplicates from csv file
def SortCVEs():
    with open("cve.csv") as csvfile:
        cveReader = csv.reader(csvfile, delimiter=",")
        for i in cveReader:
            csvContent.append(i)

    cves = list(dict.fromkeys(csvContent[0]))
    return cves

# Get score and summary for each CVE
def GetInfo(cves):
    cveSearch = CVESearch() 
    with open('output.csv', 'w', newline="") as outputFile:
        writer = csv.writer(outputFile)

        for c in cves:
            fullOutput = cveSearch.id(c)
            writer.writerow(["-----"])
            writer.writerow([str(c)])
            writer.writerow([str(fullOutput["cvss"])])
            writer.writerow([str(fullOutput["summary"])])
            time.sleep(1)

cves = SortCVEs()
#cves = ["CVE-2021-3193","CVE-2021-21285"] #for testing
GetInfo(cves)