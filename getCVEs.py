from mitrecve import crawler
import csv 

# Gets CVE numbers from MITRE database
def GetCVEs():
    searchWords = []
    numWords = int(input("How many searches would you like to perform? "))
    cveList = []

    print("Please enter each search on a new line:")

    while len(searchWords) < numWords:
        searchWords.append(input(""))

    for s in searchWords:
        cve = crawler.get_cve_detail(s)
        for c in cve:
            cveList.append(c[0])
    return(cveList)

# Writes CVE numbers to cve.csv
def WriteOut(cves):
    with open("cve.csv", "w", newline="") as output:
        writeCVE = csv.writer(output)
        writeCVE.writerow(cves)

cves = GetCVEs()
WriteOut(cves)